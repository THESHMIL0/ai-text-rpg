<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Text RPG</title>
  <style>
    body {
      background-color: #000;
      color: #0f0;
      font-family: "Courier New", monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }

    #game {
      background: #111;
      padding: 20px;
      border: 2px solid #0f0;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
      text-align: center;
    }

    h1 {
      color: #0f0;
      margin-bottom: 20px;
    }

    #output {
      min-height: 120px;
      margin: 15px 0;
      font-size: 16px;
    }

    .btn {
      background: #0f0;
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }

    .btn:hover {
      background: #4dff4d;
    }

    .health-bar {
      height: 20px;
      background: red;
      border: 1px solid #333;
      margin: 5px 0;
      position: relative;
      border-radius: 5px;
    }

    .health-fill {
      height: 100%;
      background: limegreen;
      width: 100%;
      transition: width 0.3s;
      border-radius: 5px;
    }

    .status {
      margin: 5px 0;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="game">
    <h1>AI Text RPG</h1>

    <div class="status">‚ù§Ô∏è Player HP</div>
    <div class="health-bar"><div id="playerHP" class="health-fill"></div></div>

    <div class="status">üëæ Enemy HP</div>
    <div class="health-bar"><div id="enemyHP" class="health-fill" style="background:red;"></div></div>

    <div id="output">Welcome to the adventure! Choose your path.</div>

    <div id="buttons">
      <button class="btn" onclick="enterForest()">Enter Forest</button>
      <button class="btn" onclick="visitTown()">Visit Town</button>
    </div>
  </div>

  <script>
    let player = { hp: 100, maxHp: 100 };
    let enemy = { hp: 0, maxHp: 0 };
    let inBattle = false;

    function updateHP() {
      document.getElementById("playerHP").style.width = (player.hp / player.maxHp * 100) + "%";
      document.getElementById("enemyHP").style.width = (enemy.hp / enemy.maxHp * 100) + "%";
    }

    function enterForest() {
      if (inBattle) return;
      inBattle = true;
      enemy = { hp: 40, maxHp: 40 };
      document.getElementById("output").innerText = "A wild Goblin appears!";
      showBattleButtons();
      updateHP();
    }

    function visitTown() {
      if (inBattle) return;
      player.hp = player.maxHp;
      document.getElementById("output").innerText = "You rested at the inn. HP restored!";
      updateHP();
    }

    function showBattleButtons() {
      document.getElementById("buttons").innerHTML = `
        <button class="btn" onclick="attack()">Attack</button>
        <button class="btn" onclick="runAway()">Run Away</button>
      `;
    }

    function showMainButtons() {
      document.getElementById("buttons").innerHTML = `
        <button class="btn" onclick="enterForest()">Enter Forest</button>
        <button class="btn" onclick="visitTown()">Visit Town</button>
      `;
    }

    function attack() {
      if (!inBattle) return;
      let playerDamage = Math.floor(Math.random() * 15) + 5;
      enemy.hp -= playerDamage;
      if (enemy.hp <= 0) {
        enemy.hp = 0;
        document.getElementById("output").innerText = "You defeated the Goblin!";
        inBattle = false;
        showMainButtons();
        updateHP();
        return;
      }

      let enemyDamage = Math.floor(Math.random() * 10) + 3;
      player.hp -= enemyDamage;
      if (player.hp <= 0) {
        player.hp = 0;
        document.getElementById("output").innerText = "You were defeated... Back to town.";
        inBattle = false;
        player.hp = 1; // survive with 1 HP
        showMainButtons();
      } else {
        document.getElementById("output").innerText =
          `You hit the Goblin for ${playerDamage} damage!\nThe Goblin hit you for ${enemyDamage} damage!`;
      }
      updateHP();
    }

    function runAway() {
      document.getElementById("output").innerText = "You escaped back to town!";
      inBattle = false;
      showMainButtons();
      updateHP();
    }

    updateHP();
  </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Text RPG</title>
  <meta name="theme-color" content="#0a0a0a">
  <style>
    body {
      background: black;
      color: limegreen;
      font-family: monospace;
      padding: 20px;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      box-sizing: border-box;
    }
    #game {
      max-width: 720px;
      width: 100%;
      background:#0a0a0a;
      border: 3px solid #00ff55;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 30px rgba(0,255,120,0.08), inset 0 0 40px rgba(0,255,120,0.02);
    }
    h1 { text-align:center; color:#00ff66; margin:6px 0 12px 0; font-size:2rem; }
    #stats, #enemy, #message { border:2px solid #00ff55; padding:12px; border-radius:8px; background:#101010; min-height:46px; margin-bottom:12px; }
    #actions { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
    button {
      background: #00ff55;
      color: #000;
      border: none;
      padding:12px 16px;
      border-radius:8px;
      cursor:pointer;
      min-width:150px;
      font-size:1rem;
    }
    button.secondary { background:#111; color:#00ff66; border:1px solid #00ff55; }
    button:disabled { opacity:0.35; transform:none; cursor:not-allowed; }
    .bar-container { width:100%; background:#232323; border-radius:6px; height:18px; overflow:hidden; border:1px solid rgba(0,255,120,0.08); margin:6px 0; }
    .bar { height:100%; transition:width 220ms linear; }
    .player-bar { background: linear-gradient(90deg,#00ff66,#32ff7e); }
    .enemy-bar { background: linear-gradient(90deg,#ff6b6b,#ff8787); }
    .small { font-size:0.9rem; padding:8px 10px; min-width:120px; }
    @media (max-width:560px) {
      button { min-width: 120px; font-size:0.95rem; padding:12px; }
    }
  </style>
</head>
<body>
  <div id="game">
    <h1>‚öîÔ∏è AI Text RPG ‚öîÔ∏è</h1>
    <div id="stats"></div>
    <div id="enemy"></div>
    <div id="actions"></div>
    <div id="message"></div>
  </div>

  <script>
  // ---------- Game state ----------
  let player = {
    hp: 40, maxHp: 40, potions: 2,
    gold: 0, level: 1, xp: 0,
    baseAttack: 5, baseDefense: 0,
    equippedWeapon: null,
    equippedShield: null,
    inventory: [],
    isPoisoned: false,
    hasQuest: false,
    quiver: 0
  };

  let enemy = null;
  let poisonInterval = null;

  const monsters = [
    { name: "Goblin", hp: 10, attack: 3, gold: 5, xp: 5 },
    { name: "Troll", hp: 20, attack: 5, gold: 10, xp: 10 },
    { name: "Dragon", hp: 35, attack: 8, gold: 20, xp: 20 },
    { name: "Swamp Serpent", hp: 15, attack: 6, gold: 15, xp: 12, canPoison: true },
    { name: "Ancient Guardian", hp: 50, attack: 10, gold: 50, xp: 50, isBoss: true }
  ];

  // ---------- UI helpers ----------
  const statsEl = document.getElementById("stats");
  const enemyEl = document.getElementById("enemy");
  const actionsEl = document.getElementById("actions");
  const messageEl = document.getElementById("message");

  function updateStats() {
    const weaponName = player.equippedWeapon ? player.equippedWeapon.name : "Fists";
    const weaponAtk = player.equippedWeapon ? player.equippedWeapon.attack : 0;
    const shieldName = player.equippedShield ? player.equippedShield.name : "None";
    const shieldDef = player.equippedShield ? player.equippedShield.defense : 0;
    const totalAtk = player.baseAttack + weaponAtk;
    const totalDef = player.baseDefense + shieldDef;

    const hpPercent = Math.max(0, Math.min(100, (player.hp / player.maxHp) * 100));

    statsEl.innerHTML = `
      <strong>üßô Player</strong><br>
      <div class="bar-container"><div class="bar player-bar" style="width:${hpPercent}%"></div></div>
      HP: ${player.hp} / ${player.maxHp} ${player.isPoisoned ? "(Poisoned)" : ""} <br>
      Weapon: ${weaponName} (Attack: ${totalAtk}) | Shield: ${shieldName} (Def: ${totalDef})<br>
      Potions: ${player.potions} | Arrows: ${player.quiver} | Gold: ${player.gold} | XP: ${player.xp} | Level: ${player.level}
      ${player.hasQuest ? " | Quest: Defeat Guardian" : ""}
    `;
  }

  function showMessage(text) {
    messageEl.innerHTML = `<p>${text}</p>`;
  }

  function clearEnemyBox() {
    enemyEl.innerHTML = "";
  }

  function showEnemy() {
    if (!enemy) { enemyEl.innerHTML = ""; return; }
    const enemyPct = Math.max(0, Math.min(100, (enemy.hp / enemy.maxHp) * 100));
    enemyEl.innerHTML = `
      <strong>üëπ ${enemy.name}</strong><br>
      <div class="bar-container"><div class="bar enemy-bar" style="width:${enemyPct}%"></div></div>
      HP: ${enemy.hp} / ${enemy.maxHp}
    `;
  }

  function setActions(htmlOrButtons) {
    // If array of buttons passed, render them, else set innerHTML
    if (Array.isArray(htmlOrButtons)) {
      actionsEl.innerHTML = "";
      htmlOrButtons.forEach(b => {
        const btn = document.createElement("button");
        btn.className = b.class || "";
        btn.textContent = b.text;
        btn.onclick = b.action;
        if (b.disabled) btn.disabled = true;
        actionsEl.appendChild(btn);
      });
    } else {
      actionsEl.innerHTML = htmlOrButtons;
    }
  }

  // ---------- Save / Load ----------
  function saveGame() {
    try {
      const data = JSON.stringify(player);
      localStorage.setItem("ai_rpg_save", data);
      showMessage("üíæ Game saved.");
    } catch (e) {
      showMessage("Error saving game.");
    }
  }

  function loadGame() {
    try {
      const raw = localStorage.getItem("ai_rpg_save");
      if (!raw) return false;
      const data = JSON.parse(raw);
      // basic validation
      if (typeof data.hp === "number") {
        player = Object.assign(player, data);
        updateStats();
        showMessage("‚ôªÔ∏è Game loaded.");
        return true;
      }
    } catch (e) {
      console.error(e);
      showMessage("Error loading save.");
    }
    return false;
  }

  // ---------- Main menu ----------
  function showMainMenu() {
    enemy = null;
    clearEnemyBox();
    updateStats();
    showMessage("Where will you go?");
    setActions([
      { text: "üå≤ Enter Forest", action: goForest },
      { text: "üíß Explore Swamp", action: goSwamp },
      { text: "üï≥ Explore Cave", action: goCave },
      { text: "üèò Visit Village", action: visitVillage },
      { text: "üéí Inventory", action: showInventory },
      { text: "üíæ Save Game", action: saveGame }
    ]);
  }

  // ---------- Locations ----------
  function goForest() {
    showMessage("The forest offers choices of monsters. Pick wisely.");
    // Buttons will show but Dragon locked until level 4, Troll locked until level 2
    setActions([
      { text: "Goblin (Easy)", action: () => startBattle(monsters[0]) },
      { text: `Troll (Level 2+)${player.level < 2 ? " ‚Äî LOCKED" : ""}`, action: () => {
          if (player.level < 2) { alert("‚ùå You must be Level 2 to fight the Troll!"); return; }
          startBattle(monsters[1]);
        }, disabled:false },
      { text: `Dragon (Level 4+)${player.level < 4 ? " ‚Äî LOCKED" : ""}`, action: () => {
          if (player.level < 4) { alert("‚ùå You must be Level 4 to fight the Dragon!"); return; }
          startBattle(monsters[2]);
        }, disabled:false },
      { text: "‚¨ÖÔ∏è Back", action: showMainMenu, class: "secondary" }
    ]);
  }

  function goSwamp() {
    showMessage("You wade into the swamp...");
    startBattle(monsters.find(m => m.name === "Swamp Serpent"));
  }

  function goCave() {
    if (player.hasQuest) {
      const guardian = monsters.find(m => m.isBoss);
      startBattle(guardian);
    } else {
      showMessage("The cave feels ominous. A shrine in the village offers a quest to enter.");
      setTimeout(showMainMenu, 1400);
    }
  }

  function visitVillage() {
    showMessage("Welcome to the village. Rest, shop, or learn rumors.");
    setActions([
      { text: "üõå Rest (free)", action: () => { player.hp = player.maxHp; player.isPoisoned = false; clearPoison(); updateStats(); showMessage("You rest and recover fully."); setTimeout(showMainMenu,900); } },
      { text: "üõç Visit Shop", action: visitShop },
      { text: "üç∫ Tavern", action: visitTavern },
      { text: "‚ú® Shrine", action: visitShrine },
      { text: "‚¨ÖÔ∏è Back", action: showMainMenu, class: "secondary" }
    ]);
  }

  // ---------- Shop / Tavern / Shrine ----------
  function visitShop() {
    showMessage("Shopkeeper: What would you like?");
    setActions([
      { text: "üß™ Potion (10 gold)", action: buyPotion },
      { text: "‚öî Sword (15 gold)", action: buySword },
      { text: "üõ° Shield (15 gold)", action: buyShield },
      { text: "üèπ Bow & arrows (20 gold)", action: buyBow },
      { text: "‚¨ÖÔ∏è Back", action: visitVillage, class: "secondary" }
    ]);
  }

  function visitTavern() {
    showMessage("You listen to gossip in the tavern...");
    setActions([
      { text: "Talk to Barkeep", action: () => { showMessage("Barkeep: 'They say an Ancient Guardian lurks in the cave...'"); setTimeout(visitTavern, 1200); } },
      { text: "Listen for Rumors", action: () => { showMessage("You hear rumors of treasure in the swamp."); setTimeout(visitTavern, 1200); } },
      { text: "‚¨ÖÔ∏è Back", action: visitVillage, class:"secondary" }
    ]);
  }

  function visitShrine() {
    if (player.hasQuest) {
      showMessage("The sage thanks you. You've already accepted the quest.");
      setTimeout(visitVillage, 1000);
    } else {
      showMessage("Sage: 'A corrupted Guardian plagues the cave. Will you accept the quest?'");
      setActions([
        { text: "‚úÖ Accept Quest", action: () => { player.hasQuest = true; showMessage("Quest accepted: Defeat the Ancient Guardian!"); updateStats(); setTimeout(showMainMenu,1100); } },
        { text: "‚ùå Decline", action: visitVillage, class:"secondary" }
      ]);
    }
  }

  // ---------- Inventory ----------
  function showInventory() {
    let htmlButtons = [];
    if (player.inventory.length === 0) {
      showMessage("Inventory empty.");
      htmlButtons.push({ text: "‚¨ÖÔ∏è Back", action: showMainMenu, class:"secondary" });
      setActions(htmlButtons);
      return;
    }
    showMessage("Choose an item to equip or use:");
    player.inventory.forEach((it, idx) => {
      htmlButtons.push({
        text: `${it.name} ${((player.equippedWeapon && player.equippedWeapon.name === it.name) || (player.equippedShield && player.equippedShield.name === it.name)) ? "(Equipped)" : ""}`,
        action: () => { equipItem(idx); }
      });
    });
    htmlButtons.push({ text: "‚¨ÖÔ∏è Back", action: showMainMenu, class:"secondary" });
    setActions(htmlButtons);
  }

  function equipItem(idx) {
    const item = player.inventory[idx];
    if (!item) return;
    if (item.type === "weapon" || item.type === "bow") {
      player.equippedWeapon = item;
      showMessage(`Equipped ${item.name} as weapon.`);
    } else if (item.type === "shield") {
      player.equippedShield = item;
      showMessage(`Equipped ${item.name} as shield.`);
    } else {
      showMessage("Cannot equip that.");
    }
    updateStats();
    setTimeout(showInventory, 700);
  }

  // ---------- Shop purchases ----------
  function buyPotion() {
    if (player.gold >= 10) { player.gold -= 10; player.potions++; showMessage("Bought potion."); }
    else showMessage("Not enough gold.");
    updateStats();
    setTimeout(visitShop, 600);
  }

  function buySword() {
    const sword = { name:"Sword", attack: 3, type:"weapon" };
    if (player.inventory.some(i=>i.name===sword.name)) { showMessage("You already own a sword."); setTimeout(visitShop,700); return; }
    if (player.gold >= 15) { player.gold -= 15; player.inventory.push(sword); showMessage("Sword added to inventory."); updateStats(); }
    else showMessage("Not enough gold.");
    setTimeout(visitShop,700);
  }

  function buyShield() {
    const shield = { name:"Wooden Shield", defense:2, type:"shield" };
    if (player.inventory.some(i=>i.name===shield.name)) { showMessage("You already own a shield."); setTimeout(visitShop,700); return; }
    if (player.gold >= 15) { player.gold -= 15; player.inventory.push(shield); showMessage("Shield added to inventory."); updateStats(); }
    else showMessage("Not enough gold.");
    setTimeout(visitShop,700);
  }

  function buyBow() {
    const bow = { name:"Bow", attack: 7, type:"bow" };
    const hasBow = player.inventory.some(i => i.name === bow.name);
    if (!hasBow) {
      if (player.gold >= 20) { player.gold -= 20; player.inventory.push(bow); player.quiver += 20; showMessage("Bow + 20 arrows added!"); updateStats(); }
      else showMessage("Not enough gold.");
    } else {
      if (player.gold >= 5) { player.gold -= 5; player.quiver += 10; showMessage("Bought 10 arrows."); updateStats(); }
      else showMessage("Not enough gold.");
    }
    setTimeout(visitShop,700);
  }

  // ---------- Battle ----------
  function startBattle(template) {
    enemy = Object.assign({}, template);
    enemy.hp = template.hp;
    enemy.maxHp = template.hp;
    updateStats();
    showEnemy();
    showMessage(`A wild ${enemy.name} appears!`);
    // Set combat buttons (attack / potion / shoot-if-bow / run)
    let buttons = [
      { text: "‚öîÔ∏è Attack", action: attack },
      { text: "üß™ Use Potion", action: usePotion }
    ];
    if (player.equippedWeapon && player.equippedWeapon.type === "bow") {
      buttons.push({ text: `üèπ Shoot (${player.quiver})`, action: shoot });
    }
    buttons.push({ text: "üèÉ Run", action: showMainMenu, class:"secondary" });
    setActions(buttons);
  }

  function updateEnemy() { showEnemy(); }

  function attack() {
    if (!enemy || enemy.hp <= 0) return;
    const weaponAtk = player.equippedWeapon ? player.equippedWeapon.attack : 0;
    const totalAttack = player.baseAttack + weaponAtk;
    const totalDefense = player.baseDefense + (player.equippedShield ? player.equippedShield.defense : 0);

    const playerDamage = Math.floor(Math.random() * totalAttack) + 1;
    const rawEnemyDamage = Math.floor(Math.random() * enemy.attack) + 1;
    const actualEnemyDamage = Math.max(1, rawEnemyDamage - totalDefense);

    enemy.hp -= playerDamage;
    player.hp -= actualEnemyDamage;

    let msg = `You hit the ${enemy.name} for ${playerDamage}. It hits you for ${actualEnemyDamage}.`;

    // poison chance
    if (enemy.canPoison && Math.random() < 0.5 && !player.isPoisoned) {
      player.isPoisoned = true;
      startPoison();
      msg += " You feel a venomous bite!";
    }

    updateEnemy();
    updateStats();
    showMessage(msg);

    if (enemy.hp <= 0) {
      handleMonsterDefeat();
      return;
    }
    if (player.hp <= 0) {
      handlePlayerDefeat();
      return;
    }

    // continue choices
    let contButtons = [
      { text: "‚öî Attack Again", action: attack },
      { text: "üß™ Use Potion", action: usePotion }
    ];
    if (player.equippedWeapon && player.equippedWeapon.type === "bow") {
      contButtons.push({ text: `üèπ Shoot (${player.quiver})`, action: shoot });
    }
    contButtons.push({ text: "üèÉ Run", action: showMainMenu, class:"secondary" });
    setActions(contButtons);
  }

  function shoot() {
    if (!enemy || enemy.hp <= 0) return;
    if (player.quiver <= 0) { showMessage("Out of arrows!"); return; }
    const bowAtk = player.equippedWeapon ? player.equippedWeapon.attack : 0;
    const totalBow = player.baseAttack + bowAtk;
    const playerDamage = Math.floor(Math.random() * totalBow) + 1;
    const rawEnemyDamage = Math.floor(Math.random() * enemy.attack) + 1;
    const actualEnemyDamage = Math.max(1, rawEnemyDamage - (player.equippedShield ? player.equippedShield.defense : 0));
    player.quiver--;
    enemy.hp -= playerDamage;
    player.hp -= actualEnemyDamage;

    updateEnemy();
    updateStats();
    showMessage(`You shoot an arrow for ${playerDamage}. Enemy hits you for ${actualEnemyDamage}.`);

    if (enemy.hp <= 0) { handleMonsterDefeat(); return; }
    if (player.hp <= 0) { handlePlayerDefeat(); return; }

    setActions([
      { text: "‚öî Attack", action: attack },
      { text: "üß™ Use Potion", action: usePotion },
      { text: `üèπ Shoot (${player.quiver})`, action: shoot },
      { text: "üèÉ Run", action: showMainMenu, class:"secondary" }
    ]);
  }

  function usePotion() {
    if (player.potions <= 0) { showMessage("No potions left."); return; }
    player.potions--;
    player.hp = Math.min(player.maxHp, player.hp + 12);
    if (player.isPoisoned) { player.isPoisoned = false; clearPoison(); showMessage("You used a potion and cured poison + restored HP."); }
    else showMessage("You used a potion and restored HP.");
    updateStats();
    // after using a potion continue combat choices
    if (enemy && enemy.hp > 0) {
      setActions([
        { text: "‚öî Attack", action: attack },
        { text: "üß™ Use Potion", action: usePotion },
        ...(player.equippedWeapon && player.equippedWeapon.type==="bow" ? [{ text: `üèπ Shoot (${player.quiver})`, action: shoot }] : []),
        { text: "üèÉ Run", action: showMainMenu, class:"secondary" }
      ]);
    } else {
      setTimeout(showMainMenu, 700);
    }
  }

  function handleMonsterDefeat() {
    if (!enemy) return;
    // rewards
    player.gold += enemy.gold || 0;
    player.xp += enemy.xp || 0;
    const wasBoss = !!enemy.isBoss;
    const name = enemy.name;
    enemy = null;
    updateStats();
    if (wasBoss) {
      player.hasQuest = false;
      showMessage(`You defeated ${name}! Quest complete. +${player.xp} XP, +${player.gold} gold.`);
    } else {
      showMessage(`You defeated ${name}! +${player.xp} XP, +${player.gold} gold.`);
    }
    levelUpCheck();
    setTimeout(showMainMenu, 1200);
  }

  function handlePlayerDefeat() {
    showMessage("üíÄ You were defeated... Respawning in village with 1 HP.");
    // penalty: lose some gold maybe
    player.gold = Math.max(0, player.gold - 5);
    player.hp = 1;
    player.isPoisoned = false;
    clearPoison();
    updateStats();
    setTimeout(showMainMenu, 1000);
  }

  // ---------- Poison ----------
  function startPoison() {
    if (poisonInterval) return;
    poisonInterval = setInterval(() => {
      if (!player.isPoisoned) { clearPoison(); return; }
      player.hp -= 2;
      updateStats();
      showMessage("Poison deals 2 damage!");
      if (player.hp <= 0) { player.hp = 0; updateStats(); handlePlayerDefeat(); }
    }, 1000);
  }

  function clearPoison() {
    if (poisonInterval) { clearInterval(poisonInterval); poisonInterval = null; }
    player.isPoisoned = false;
  }

  // ---------- Level up ----------
  function levelUpCheck() {
    const need = player.level * 20;
    if (player.xp >= need) {
      player.xp -= need;
      player.level++;
      player.maxHp += 5;
      player.baseAttack += 2;
      player.baseDefense += 1;
      player.hp = player.maxHp;
      showMessage(`üåü Level up! You are now Level ${player.level}.`);
      updateStats();
    }
  }

  // ---------- Restart ----------
  function restart() {
    player = {hp:40, maxHp:40, potions:2, gold:0, level:1, xp:0, baseAttack:5, baseDefense:0, equippedWeapon:null, equippedShield:null, inventory:[], isPoisoned:false, hasQuest:false, quiver:0};
    enemy = null;
    clearPoison();
    updateStats();
    showMainMenu();
  }

  // ---------- Boot ----------
  // load if exists, then always show main menu
  const loaded = loadGame();
  setTimeout(() => {
    // ensure UI updates after load
    updateStats();
    if (!loaded) showMessage("Welcome! Your adventure begins.");
    setTimeout(showMainMenu, 250);
  }, 120);

  </script>
</body>
</html>